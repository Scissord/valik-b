# Телеграм боты для системы управления заказами

## Обзор
В системе используются два отдельных телеграм бота:
1. **Бот для клиентов** - позволяет клиентам отслеживать заказы, получать уведомления и просматривать историю заказов
2. **Бот для менеджеров** - позволяет менеджерам управлять заказами, менять статусы и получать уведомления о новых заказах

## Настройка переменных окружения

1. Откройте файл `.env` в корне проекта
2. Добавьте следующие строки:
```
# Настройки бота для клиентов
TELEGRAM_CLIENT_BOT_TOKEN=токен_бота_для_клиентов

# Настройки бота для менеджеров
TELEGRAM_MANAGER_BOT_TOKEN=токен_бота_для_менеджеров

#Настройки бота для поставщиков
TELEGRAM_SUPPLIER_BOT_TOKEN=токен_бота_поставщиков

## Получение токенов

1. Для создания нового бота, найдите @BotFather в Telegram
2. Отправьте ему команду `/newbot` и следуйте инструкциям
3. После успешного создания, вы получите токен бота
4. Создайте два разных бота: один для клиентов и один для менеджеров

## Перезапуск сервера

После настройки переменных окружения перезапустите сервер, чтобы изменения вступили в силу.

## Функциональность ботов

### Бот для клиентов

- **Авторизация** - клиенты могут авторизоваться по номеру телефона
- **Просмотр заказов** - просмотр истории и статусов заказов
- **Профиль** - просмотр информации о своем профиле
- **Уведомления** - автоматические уведомления о создании заказа и изменении его статуса

### Бот для менеджеров

- **Авторизация** - менеджеры авторизуются по логину и паролю
- **Просмотр всех заказов** - доступ ко всем заказам в системе
- **Фильтрация заказов** - фильтрация по статусам
- **Изменение статусов** - изменение статуса заказа с автоматическим уведомлением клиента
- **Уведомления** - мгновенные уведомления о новых заказах с кнопками управления

### Команды ботов

#### Бот для клиентов:
- `/start` - начать работу с ботом
- `/help` - показать список доступных команд
- `/menu` - открыть главное меню
- `/logout` - выйти из аккаунта

#### Бот для менеджеров:
- `/start` - начать работу с ботом
- `/help` - показать список доступных команд
- `/menu` - открыть главное меню
- `/orders` - показать список последних заказов
- `/status {id}` - показать статус заказа по ID с кнопками для изменения статуса
- `/logout` - выйти из аккаунта

## Тестирование

1. Авторизуйтесь в боте для клиентов с помощью номера телефона существующего клиента
2. Авторизуйтесь в боте для менеджеров с помощью логина и пароля менеджера
3. Создайте тестовый заказ через API - оба бота должны отправить уведомления
4. В боте для менеджеров измените статус заказа и проверьте, что клиент получает уведомление

## Устранение неполадок

Если уведомления не приходят или кнопки не работают:
1. Проверьте правильность токенов ботов и ID чатов в файле `.env`
2. Убедитесь, что боты имеют доступ к отправке сообщений в указанные чаты
3. Проверьте логи сервера на наличие ошибок при отправке уведомлений
4. Убедитесь, что включен режим polling для ботов (параметр `polling: true` при создании экземпляра бота)
5. Перезапустите сервер после внесения изменений в настройки
